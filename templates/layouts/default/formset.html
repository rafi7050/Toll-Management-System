{% load crispy_forms_tags static %}
<div class="form_set_container">
    {{ formset.management_form|crispy }}
    {% for form in formset.forms %}
        <div class="{% cycle 'row1' 'row2' %} formset_row-{{ formset.prefix }} row p-0 m-0">
            {% for field in form.visible_fields %}
                {% if not field.name == 'DELETE' %}
                    {% if field.name == "product" %}
                        <div class="col {{ field.name }}_select">
                            {# Include the hidden fields in the form #}
                            {% if forloop.first %}
                                {% for hidden in form.hidden_fields %}
                                    {{ hidden }}
                                {% endfor %}
                            {% endif %}
                            {{ field.errors.as_ul }}
                            {{ field|as_crispy_field }}
                        </div>
                    {% else %}
                        <div class="col {{ field.name }}_select">
                            {# Include the hidden fields in the form #}
                            {% if forloop.first %}
                                {% for hidden in form.hidden_fields %}
                                    {{ hidden }}
                                {% endfor %}
                            {% endif %}
                            {{ field.errors.as_ul }}
                            {{ field|as_crispy_field }}
                        </div>
                    {% endif %}

                {% endif %}
            {% endfor %}
        </div>
    {% endfor %}
</div>
<br>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.formset/1.2.2/jquery.formset.js"></script>
<script type="text/javascript">
    $('.formset_row-{{ formset.prefix }}').formset({
        addText: '<button class="btn btn-success rounded-0 btn-md">+</button>',
        deleteText: '<button class="btn btn-danger rounded-0 btn-md">-</button>',
        {#deleteCssClass: 'delete-row justify-content-center align-self-center',#}
        prefix: '{{ formset.prefix }}',
        animateForms: true,
        removed: function () {
        },
        added: function () {
            $('.dynamic-form:last').find('select').find('option').each(function () {
                $(this).text(RemoveQuantityUnitFromProduct($(this).text()))
            })
            $('.dynamic-form:last').find('select').find('option').prop('selected', false)
            $('.dynamic-form:last').find('select').select2()
            $('.dynamic-form:last').find('.quantity_select').find('input').val(1)
        }
    });


</script>